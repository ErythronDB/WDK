#!/usr/bin/perl

my ($wdkModel, $annotQuestion, $seqQuestion, $outputFile) = @ARGV;
die "\ngffDump <wdkModel> <AnnotationFullQuestion> <SequenceFullQuestion> <OutputFile>\n\n"
  unless $wdkModel && $annotQuestion && $seqQuestion && $outputFile;

my $annotXmlFile = $outputFile . '.annotation.xml';
my $seqXmlFile = $outputFile . '.sequence.xml';
my $cmd;

$cmd = "wdkSummary -model $wdkModel -question $annotQuestion -toXml $annotXmlFile";
print "running $cmd ...\n";
system("$cmd"); # or die "could not dump annotation data via wdkSummary";

$cmd = "wdkSummary -model $wdkModel -question $seqQuestion -toXml $seqXmlFile";
print "running $cmd ...\n";
system("$cmd"); # or die "cound not dump sequence data via wdkSummary";

$cmd = "xmlToGff $annotXmlFile $outputFile";
print "running $cmd ...\n";
system("$cmd"); # or die "could not convert annotation xml into GFF";

$cmd = "xmlToGff $seqXmlFile $outputFile 1";
print "running $cmd ...\n";
system("$cmd"); # or die "could not convert sequence xml into GFF";

$cmd = "/bin/rm $annotXmlFile $seqXmlFile";
print "running $cmd ...\n";
system("$cmd");
