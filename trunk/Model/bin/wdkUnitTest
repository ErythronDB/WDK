#!/usr/bin/perl

use Carp;

my $GUS_HOME=$ENV{GUS_HOME};

my $javaDir = "$GUS_HOME/lib/java";

opendir(DATADIR, $javaDir) || &confess ("Error:  Could not open $javaDir.  Please check the directory exists and try again.");

my $CLASSPATH = "";

while (my $nextFileName = readdir(DATADIR)){
    if ($nextFileName =~ /.*\.jar$/){
	$CLASSPATH .= "$javaDir/$nextFileName" . ":"
    }
}

my $sysargs = "";
my $args = "";
foreach my $arg (@ARGV) {
    # $args .= ($arg =~ /\-/ ? " $arg" : " \"$arg\"");

    if ($arg =~ /\-/) {
        $args .= " $arg";
        $arg =~ s/\-/\-D/g;
        $sysargs .= " $arg=";
    } else {
        $args .= " \"$arg\"";
        $sysargs .= "\"$arg\"";
    }
}
#print "$args\n";

my $cmd = "java -DcmdName=wdkUnitTest -DconfigDir=$GUS_HOME/config -DschemaFile=$GUS_HOME/lib/rng/wdkModel.rng -DsanitySchemaFile=$GUS_HOME/lib/rng/sanityModel.rng $sysargs -cp $CLASSPATH org.gusdb.wdk.model.test.TestUtility $args";

print "$cmd\n";

system($cmd);



